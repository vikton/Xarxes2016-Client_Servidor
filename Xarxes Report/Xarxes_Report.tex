\documentclass[11pt]{article}
\usepackage{ragged2e}
\usepackage[utf8]{inputenc}
\usepackage[catalan]{babel}
\usepackage{hyperref}
\usepackage{graphicx}
\usepackage{array}

\graphicspath{ {Images/} }

\begin{document}
\begin{titlepage}

\newcommand{\HRule}{\rule{\linewidth}{0.5mm}} % Defines a new command for the horizontal lines, change thickness here

\center % Center everything on the page
 
%----------------------------------------------------------------------------------------
%	HEADING SECTIONS
%----------------------------------------------------------------------------------------

\textsc{\LARGE Universitat de Lleida}\\[1.5cm] % Name of your university/college
\includegraphics{Images/logoUDL.jpg}\\[1cm] % Include a department/university logo - this will require the graphicx package
\textsc{\Large Grau en Enginyeria Informàtica}\\[0.5cm] % Major heading such as course name
\textsc{\large Xarxes}\\[0.5cm] % Minor heading such as course title

%----------------------------------------------------------------------------------------
%	TITLE SECTION
%----------------------------------------------------------------------------------------

\HRule \\[0.4cm]
{ \huge \bfseries Pràctica 1, Programació d’aplicacions de xarxa}\\[0.4cm] % Title of your document
\HRule \\[1.5cm]
 
%----------------------------------------------------------------------------------------
%	AUTHOR SECTION
%----------------------------------------------------------------------------------------

\begin{minipage}{0.4\textwidth}
\begin{flushleft} \large
\emph{Autor:}\\
Jordi Ricard Onrubia Palacios % Your name
\end{flushleft}
\end{minipage}
~
\begin{minipage}{0.4\textwidth}
\begin{flushright} \large
\emph{Professor:} \\
Enric Guitart % Supervisor's Name
\end{flushright}
\end{minipage}\\[4cm]

%----------------------------------------------------------------------------------------
%	DATE SECTION
%----------------------------------------------------------------------------------------
{\large \today}\\[3cm] % Date, change the \today to a set date if you want to be precise
\vfill % Fill the rest of the page with whitespace
\end{titlepage}

%ABSTRACT
\newpage
\section*{Resum}
\justify
\thispagestyle{empty}

%INDEX
\newpage
\thispagestyle{empty}
\tableofcontents


\newpage
\clearpage
\pagenumbering{arabic}
\section{Client}
\justify
Programat en: Python versió 2.7.10.
\\\\
El client és un programa què es comunicarà amb el servidor, inicialment, aquest demana permís per a connectar-se, un cop connectat mantindrà una comunicació temporitzada amb el servidor per tal d'informar de la seva presencia i evitar la desconnexió amb el servidor.
%Diagrama estats
\\\\
A més a més, aquest podrà rebre una sèrie de comandes per tal d'enviar al servidor el seu arxiu de configuració o fer una petició per tal que el servidor li envii el seu arxiu de configuració.
\\\\
A continuació s'expliquen les funcions que ha de realitzar i la seva resolució.

	\subsection{Registrar-se al servidor}
Per a la realització del registre ens caldrà, primerament, crear un socket que utilitzarem per al transport de les PDUs(\textit{Protocol Data Unit}), aquest socket utilitzarà el protocol UDP(\textit{User Datagram Protocol}) per a la comunicació.
\\\\
Les PDUs seràn utilitzades per al enviament i recepció de paquets tant en el procés de registre com en el procés de manteniment de comunicació com es veurà més endavant. Per a la realització de la PDU utilitzarem la funció\textit{struct} de Python amb el contingut següent:
%%%%%%%%%%%%%
%%%%%%%%%%%%%
%%%%%%%%%%%%%
\begin{table}[h]

\def\arraystretch{1.5}
\begin{tabular}{ c c c c c c}
tipus: & unsigned char & char &  char & char & char\\
\cline{2-6}
& \multicolumn{1}{|c|}{Tipus Paquet} & \multicolumn{1}{|c|}{Nom Equip} & \multicolumn{1}{|c|}{Adreça MAC} & \multicolumn{1}{|c|}{Nùmero Aleatori} & \multicolumn{1}{|c|}{Dades}\\
\cline{2-6}
bytes: & 1 & 7 & 13 & 7 & 50
	\end{tabular}
	\caption{PDU Registre}
	\label{tab:PDUReg}
\end{table}
%%%%%%%%%%%%%
%%%%%%%%%%%%%
%%%%%%%%%%%%%
\newpage
Per a la fase de registre s'han predefinit uns paquets:\\
%%%%%%%%%%%%%
%%%%%%%%%%%%%
%%%%%%%%%%%%%
\begin{table}[h]
\centering
\def\arraystretch{1.5}
\begin{tabular}{ c l l }
\hline
Valor & Mnemònic & Significat\\
\hline
\hline
0x00 & REGISTER\_REQ & Petició de registre\\
0x01 & REGISTER\_ACK & Acceptació de registre\\
0x02 & REGISTER\_NACK & Denegació de registre\\
0x03 & REGISTER\_REJ & Rebuig de registre\\
0x09 & ERROR & Error de protocol\\
\hline
	\end{tabular}
	\caption{Paquets de Registre}
	\label{tab:PaquetsRegistre}
\end{table}
\\
%%%%%%%%%%%%%
%%%%%%%%%%%%%
%%%%%%%%%%%%%
Aquests paquets són ùnicament correctes en la fase de registre, qualsevol intent de enviament d'aquests paquets en qualsevol altre fase donarà com a resultat una recepció d'un paquet d'error per part del servidor.
\\\\
L'enviament de les PDUs de registre es farà temporitzat
	\subsection{Manteniment de communicació}
	\subsection{Esperar comandes per l'enviament/recepció del seu arxiu de configuració}
	\subsection{Funcions adicionals}

\newpage
\section{Servidor}
Compilat en: Linux versió 4.2.0 gcc versió 5.2.1.\\
Comanda utilitzada: gcc -ansi -pedantic -Wall.
\\\\
El servidor és un programa què permet respondre a les peticions de un client i respondre en concordança.
\\\\
En el nostre cas el servidor registrarà i mantindrà la comunicació amb els clients que estiguin autoritzats i que facin una petició de registre i que tambè mantinguin la comunicació per la seva part, a més a més, el servidor rebrà peticions de enviament i recepció dels arxius de configuració dels clients i se'n carregarà de respondre a ells. Per part pròpia el servidor pot mostrar tots els equips autoritzats amb les seves dades i el seu estat si es demana.
	\subsection{Enregistrament de clients}
	\subsection{Manteniment de comunicació amb equips enregistrats }
	\subsection{Enviament/recepció de arxius de configuració}
	\subsection{Espera de comandes per consola}
\section{Anexe}
	\subsection{Problemes i solucions trobats en el desenvolupament}
		\subsubsection*{Client}
		\subsection*{Servidor}
\begin{enumerate}
\item Problema de accedir i actualitzar les dades dels clients des de altres processos. La solució ha estat fer un mmap utilitzant la llibreria sys/man.h. 
\item Si els dos primers ''ALIVES'' la temporització no arriba a agafar el tercer ''ALIVE'' en cas de que fos enviat ja que aquest arriba just en el moment en que el servidor a desconectat al client. La solució ha estat aplicar un temporitzador per tal de que el servidor només comprovi els estats dels clients cada segon en lloc de continuament, a més a més, es permet que el temps en el que tindria que arribar ''l'ALIVE'' sigui més gran que l'especificat, exactament 1 segon més.
\end{enumerate}
\newpage
\section{Referències}
Importar constants d'un altre fitxer en Python 2.\\
\url{http://zetcode.com/lang/python/packages/}\\
Structs en Python 2.\\
\url{https://docs.python.org/2/library/struct.html}\\
UDP sockets en Python 2.\\
\url{https://wiki.python.org/moin/UdpCommunication}\\
Funcions de la llibreria Time de Python 2.\\	
\url{https://docs.python.org/2/library/time.html}\\
TCP sockets en Python 2.\\
\url{https://wiki.python.org/moin/TcpCommunication}\\
Signals en Python 2.\\	
\url{https://docs.python.org/2/library/signal.html}\\
UDP sockets en C.\\
\url{https://www.cs.rutgers.edu/~pxk/417/notes/sockets/udp.html}\\
Compartir memória en C.\\
\url{http://man7.org/linux/man-pages/man2/mmap.2.html}
Funcions de la llibreria Time de C.\\
\url{http://www.cplusplus.com/reference/ctime/}
\end{document}